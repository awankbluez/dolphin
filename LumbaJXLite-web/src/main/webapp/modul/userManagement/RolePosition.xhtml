<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns:ui="http://java.sun.com/jsf/facelets"
                template="./../../template.xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:p="http://primefaces.org/ui"
                xmlns:pe="http://primefaces.org/ui/extensions">

    <ui:define name="top">
        top
    </ui:define>

    <ui:define name="menuBar">
        menuBar
    </ui:define>

    <ui:define name="content">
        <p:panel closable="true" toggleable="true" header="Posisi">
            <h:form id="formFieldsetPosition" >
                <p:growl severity="info, error" showDetail="true" showSummary="true" escape="true"/>
                <p:fieldset legend="Tambah Posisi"
                            toggleable="TRUE"
                            collapsed="#{positionBean.fieldsetCollapse}"
                            toggleSpeed="500">

                    <h:panelGrid columns="2">
                        <h:panelGroup id="panelForm">
                            <h:panelGrid columns="2">
                                <p:outputLabel for="PositionCode" value="Kode Posisi"/>
                                <p:inputText id="PositionCode" value="#{positionBean.position.positioncode}" required="true" label="Kode Posisi" maxlength="4"/>

                                <p:outputLabel for="PositionName" value="Nama Posisi"/>
                                <p:inputText id="PositionName" value="#{positionBean.position.positionname}" required="true" label="Nama Posisi" maxlength="40"/>

                                <p:outputLabel for="IsAccountOfficer" value="Account Officer ?"/>
                                <p:selectOneRadio id="IsAccountOfficer" value="#{positionBean.position.isaccountofficer}">
                                    <f:selectItem itemValue="true" itemLabel="Ya"/>
                                    <f:selectItem itemValue="false" itemLabel="Tidak"/>
                                </p:selectOneRadio>

                                <p:outputLabel for="PositionStatus" value="Status"/>
                                <p:selectOneRadio id="PositionStatus" value="#{positionBean.position.positionstatus}">
                                    <f:selectItem itemValue="true" itemLabel="Aktif"/>
                                    <f:selectItem itemValue="false" itemLabel="Tidak Aktif"/>
                                </p:selectOneRadio>

                            </h:panelGrid>
                            <p:commandButton value="Simpan" icon="ui-icon ui-icon-check" update="@form :formTablePosition:tablePosition" actionListener="#{positionBean.create}" rendered="#{positionBean.status.equalsIgnoreCase('insert')}" process="@form"/>
                            <p:commandButton value="Reset" global="false" icon="ui-icon ui-icon-closethick" rendered="#{positionBean.status.equalsIgnoreCase('insert')}" actionListener="#{positionBean.reset}" update="@form"/>
                            <p:commandButton value="Rubah" icon="ui-icon ui-icon-check" update="@form :formTablePosition:tablePosition" actionListener="#{positionBean.update}" rendered="#{positionBean.status.equalsIgnoreCase('update')}"/>
                            <p:commandButton value="Cancel" global="false" icon="ui-icon ui-icon-closethick" rendered="#{positionBean.status.equalsIgnoreCase( 'update')}" actionListener="#{positionBean.reset}" update="@form"/>
                        </h:panelGroup>

                        <h:panelGroup layout="block">
                            <p:tabView style="width:700px;">
                                <p:tab title="Menu Previlege">
                                    <p:tree value="#{positionBean.treeMenu}" var="menutree" selectionMode="checkbox" selection="#{positionBean.selectedTreeMenu}">

                                        <p:treeNode>
                                            <h:outputText value="#{msgs[menutree.menuname]}"/>
                                        </p:treeNode>

                                    </p:tree>
                                </p:tab>

                                <p:tab title="Confirmation" id="tabConfirmation">
                                    <p:dataTable value="#{positionBean.confirmationdefaults}" var="confirmationMenu">
                                        <p:column headerText="Confirmation ?" style="width: 100px;">
                                            <p:selectBooleanCheckbox value="#{confirmationMenu.needconfirmation}" style="width: 100px;"/>
                                        </p:column>

                                        <p:column headerText="Process ?">
                                            <h:outputText value="#{confirmationMenu.menu.menuname}"/>
                                        </p:column>
                                    </p:dataTable>
                                    <p:commandButton actionListener="#{positionBean.submitconfirmationmenu}" onclick="testDialog.show();" update=":formTest" process="tabConfirmation"/>
                                </p:tab>

                                <p:tab title="Role">
                                    <h:panelGroup layout="block">
                                        <h:panelGrid columns="2">
                                            <p:dataTable value="#{positionBean.userroutingroleDefaults}" var="userroutingroledefault">

                                                <p:column headerText="Process">
                                                    <h:outputText value="#{userroutingroledefault.menu.menuname}"/>
                                                </p:column>

                                                <p:column headerText="Previlage">
                                                    <h:panelGrid columns="6">
                                                        <p:selectBooleanCheckbox id="boolMaker" value="#{userroutingroledefault.maker}"/>
                                                        <p:outputLabel for="boolMaker" value="Maker"/>
                                                        <p:selectBooleanCheckbox id="boolCehcker" value="#{userroutingroledefault.checker}"/>
                                                        <p:outputLabel for="boolMaker" value="Checker"/>
                                                        <p:selectBooleanCheckbox id="boolApproval" value="#{userroutingroledefault.approval}"/>
                                                        <p:outputLabel for="boolMaker" value="Approval"/>
                                                    </h:panelGrid>
                                                </p:column>

                                                <p:column headerText="Target">
                                                    <h:panelGrid columns="2">
                                                        <p:outputLabel for="nextTarget" value="Next Target"/>
                                                        <p:selectOneMenu id="nextTarget" style="width: 200px;">
                                                            <f:selectItem itemLabel="Select Next Target Position"/>
                                                            <f:selectItems value="#{positionBean.positionList}" var="position" itemLabel="#{position.positioncode} | #{position.positionname}" itemValue="#{position.positionid}" />
                                                        </p:selectOneMenu>
                                                    </h:panelGrid>
                                                </p:column>

                                                <p:column headerText="List Target">

                                                    <p:dataTable rendered="#{userroutingroledefault.menu.menuid == 200}">
                                                        <f:facet name="header">
                                                            <p:commandButton value="Add" icon="ui-icon ui-icon-plusthick" onclick="addTarget.show();"/>
                                                        </f:facet>
                                                        <p:column headerText="Next Target Position">

                                                        </p:column>
                                                        <p:column headerText="Level">

                                                        </p:column>
                                                        <p:column>

                                                        </p:column>
                                                    </p:dataTable>
                                                </p:column>
                                            </p:dataTable>

                                            <h:outputText />
                                        </h:panelGrid>
                                    </h:panelGroup>
                                </p:tab>


                            </p:tabView>
                        </h:panelGroup>
                    </h:panelGrid>
                </p:fieldset>
            </h:form>

            <h:form id="formTablePosition" >
                <p:dataTable
                    id="tablePosition"
                    value="#{positionBean.positionList}"
                    var="position"
                    emptyMessage="Tidak Ada Posisi"
                    sortOrder="descending">

                    <pe:paginator
                        paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                        rows="10"
                        rowsPerPageTemplate="5,10,15"
                        />

                    <f:facet name="header">Daftar Jabatan</f:facet>

                    <p:column headerText="Kode" sortBy="#{position.positioncode}" filterBy="#{position.positioncode}" filterMatchMode="contains">
                        <h:outputText value="#{position.positioncode}"/>
                    </p:column>

                    <p:column headerText="Nama" sortBy="#{position.positionname}" filterBy="#{position.positionname}" filterMatchMode="contains">
                        <h:outputText value="#{position.positionname}"/>
                    </p:column>

                    <p:column headerText="Account Officer ?" style="width: 70px; text-align: center;">
                        <p:commandButton icon="ui-icon ui-icon-check" title="Yes" rendered="#{position.isaccountofficer == true}"/>
                        <p:commandButton icon="ui-icon ui-icon-closethick" title="No" rendered="#{position.isaccountofficer == false}"/>
                    </p:column>

                    <p:column headerText="Status" style="width: 80px; text-align: center;">
                        <p:commandButton icon="ui-icon ui-icon-check" title="Active" rendered="#{position.positionstatus == true}"/>
                        <p:commandButton icon="ui-icon ui-icon-closethick" title="Inactive" rendered="#{position.positionstatus == false}"/>
                    </p:column>

                    <p:column headerText="" style="width: 80px;">
                        <p:commandButton icon="ui-icon ui-icon-pencil" title="Edit #{position.positionname}" actionListener="#{positionBean.edit(position)}" update=":formFieldsetPosition"/>
                        <p:commandButton icon="ui-icon ui-icon-trash" title="Delete #{position.positionname}" actionListener="#{positionBean.delete(position)}" update="@form"/>
                    </p:column>
                </p:dataTable>
            </h:form>
        </p:panel>

        <p:dialog header="Edit User Access Menu" widgetVar="EditUserMenuDialog" modal="true" hideEffect="fade" showEffect="fade">
            <h:form id="formDialogEditUserAccessMenu">
                <p:dataTable value="#{positionBean.mainMenuList}" var="mainmenu" scrollHeight="400">

                    <pe:paginator
                        paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                        rows="20"
                        rowsPerPageTemplate="5,10,15"
                        />

                    <p:column headerText="Menu">
                        <h:outputText value="#{mainmenu.menuname}"/>
                    </p:column>

                    <p:column headerText="Level">
                        <h:outputText value="#{mainmenu.level}"/>
                    </p:column>

                    <p:column headerText="Accessible ?">
                        <p:selectBooleanCheckbox/>
                    </p:column>
                </p:dataTable>

                <h:panelGrid columns="2">
                    <p:commandButton value="Save"/>
                    <p:commandButton value="Cancel" onclick="EditUserMenuDialog.hide()"/>
                </h:panelGrid>
            </h:form>
        </p:dialog>

        <p:dialog  header="tes" height="300" width="400" widgetVar="testDialog">
            <h:form id="formTest">
                <p:dataTable value="#{positionBean.editedConfirmationdefaults}" var="confDefault">
                    <p:column headerText="?">
                        <p:selectBooleanCheckbox value="#{confDefault.needconfirmation}"/>
                    </p:column>

                    <p:column headerText="?">
                        <h:outputText value="#{confDefault.menu.menuname}"/>
                    </p:column>
                </p:dataTable>
            </h:form>
        </p:dialog>

    </ui:define>

    <ui:define name="bottom">
        bottom
    </ui:define>

</ui:composition>
