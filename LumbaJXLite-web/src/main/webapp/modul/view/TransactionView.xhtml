<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns:ui="http://java.sun.com/jsf/facelets"
                template="./../../template.xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                xmlns:f="http://java.sun.com/jsf/core">

   <ui:define name="content">
      <p:panel header="#{msgs.formTransaction}" collapsed="false" toggleable="true" closable="true" toggleSpeed="500" closeSpeed="2000" id="panelK">
         <h:form id="transaction1">
            <h:panelGrid columns="10" id="panelTr1">
               <h:outputText value="#{msgs.customername}"/>
               <h:outputText value=":"/>
               <p:autoComplete minQueryLength="3"  id="CustomerName" completeMethod="#{transactionviewBean.complete}" value="#{transactionviewBean.customername}"  required="true" style="width: 200px">
                  <f:ajax event="itemSelect" execute="@this" render="CustomerNumber Branch"/>
               </p:autoComplete>
               <p:spacer width="10"/>
               <h:outputText value="#{msgs.productType}"/>
               <h:outputText value=":"/>
               <p:selectOneRadio id="ProductType" value="#{transactionviewBean.producttype}" >
                  <f:selectItem itemLabel="#{msgs.saving}" itemValue="S"/>
                  <f:selectItem itemLabel="#{msgs.loan}" itemValue="L" />
                  <p:ajax listener="#{transactionviewBean.combo()}" update="accountCode"/>
               </p:selectOneRadio>
               <p:spacer width="10"/>
               <p:spacer width="10"/>
               <p:spacer width="10"/>

               <h:outputText value="#{msgs.customernumber}"/>
               <h:outputText value=":"/>
               <h:inputText value="#{transactionviewBean.customercode}" id="CustomerNumber" disabled="true" style="width: 107px"/>
               <p:spacer width="10"/>
               <h:outputText value="#{msgs.account}"/>
               <h:outputText value=":"/>
               <p:selectOneMenu id="accountCode" value="#{transactionviewBean.accountcode}" style="width: 127px">
                  <f:selectItem  itemLabel="Pilih Account" itemValue="0"/>
                  <f:selectItems value="#{transactionviewBean.dtCmbTransaction}"/>
                  <p:ajax process="@this"/>
               </p:selectOneMenu>
               <p:spacer width="10"/>
               <p:spacer width="10"/>
               <p:spacer width="10"/>

               <h:outputText value="#{msgs.branch}"/>
               <h:outputText value=":"/>
               <h:inputText value="#{transactionviewBean.branch}" id="Branch" disabled="true" style="width: 107px"/>
               <p:spacer width="10"/>
               <h:outputText value="#{msgs.transaction}"/>
               <h:outputText value=":"/>
               <p:selectOneRadio id="Transaction" value="#{transactionviewBean.transaction}" >
                  <f:selectItem itemLabel="#{msgs.today}" itemValue="T"/>
                  <f:selectItem itemLabel="#{msgs.history}" itemValue="H" />
                  <p:ajax listener="#{transactionviewBean.listtoday()}" update=":transaction2:tabelReceiptView panelTr1" process="@this"/>
               </p:selectOneRadio>
               <p:spacer width="10"/>
               <p:spacer width="10"/>
               <p:spacer width="10"/>

               <p:spacer width="10" rendered="#{transactionviewBean.transaction == 'T'}"/>
               <p:spacer width="10" rendered="#{transactionviewBean.transaction == 'T'}"/>
               <p:spacer width="10" rendered="#{transactionviewBean.transaction == 'T'}"/>
               <p:spacer width="10" rendered="#{transactionviewBean.transaction == 'T'}"/>
               <h:outputText value="#{msgs.transactiondate}" rendered="#{transactionviewBean.transaction == 'T'}"/>
               <h:outputText value=":" rendered="#{transactionviewBean.transaction == 'T'}"/>
               <h:inputText value="#{transactionviewBean.tgl}" id="DateNow" readonly="true" rendered="#{transactionviewBean.transaction == 'T'}">
                  <f:convertDateTime pattern="yyyy-MM-dd" />
               </h:inputText>
               <p:spacer width="10" rendered="#{transactionviewBean.transaction == 'T'}"/>
               <p:spacer width="10" rendered="#{transactionviewBean.transaction == 'T'}"/>
               <p:spacer width="10" rendered="#{transactionviewBean.transaction == 'T'}"/>

               <p:spacer width="10" rendered="#{transactionviewBean.transaction == 'H'}"/>
               <p:spacer width="10" rendered="#{transactionviewBean.transaction == 'H'}"/>
               <p:spacer width="10" rendered="#{transactionviewBean.transaction == 'H'}"/>
               <p:spacer width="10" rendered="#{transactionviewBean.transaction == 'H'}"/>
               <h:outputText value="#{msgs.transactiondate}" rendered="#{transactionviewBean.transaction == 'H'}"/>
               <h:outputText value=":" rendered="#{transactionviewBean.transaction == 'H'}"/>
               <p:calendar value="#{transactionviewBean.tgl1}" id="tgl1" yearRange="c-120:c+20" navigator="true" pattern="yyyy-MM-dd" rendered="#{transactionviewBean.transaction == 'H'}">
                  <p:ajax process="@this"/>
               </p:calendar>
               <h:outputText value="#{msgs.to}" rendered="#{transactionviewBean.transaction == 'H'}"/>
               <p:calendar value="#{transactionviewBean.tgl2}" id="tgl2" yearRange="c-120:c+20" navigator="true" pattern="yyyy-MM-dd" rendered="#{transactionviewBean.transaction == 'H'}">
                  <p:ajax process="@this"/>
               </p:calendar>
               <p:spacer width="10"/>

               <p:spacer width="10" rendered="#{transactionviewBean.transaction == 'H'}"/>
               <p:spacer width="10"/>
               <p:commandButton id="cari" value="#{msgs.searchButton}" update=":transaction2" action="#{transactionviewBean.listUtama()}" process="@form"/>
               <p:commandButton id="reset" value="#{msgs.resetButton}"  actionListener="#{transactionviewBean.reset()}" update="@form :transaction2:tabelReceiptView :panelK" process="@this"/>

               <p:spacer width="10"/>
               <p:spacer width="10"/>
               <p:spacer width="10"/>
            </h:panelGrid>
         </h:form>
         <br/>
         <h:form id="transaction2">
            <p:dataTable value="#{transactionviewBean.dtListTransaction}"
                         var="transactionlist"
                         id="tabelReceiptView"
                         paginator="true"
                         paginatorPosition="top"
                         rows="10"
                         rowsPerPageTemplate="5,10,20,25"
                         resizableColumns="true"
                         sortOrder="desc"
                         selection="#{transactionviewBean.dialogTransactionSelected}" selectionMode="single" rowKey="#{transactionlist.receiptnumber}">

               <p:ajax event="rowSelect" oncomplete="varDialogTransaction.show()" update=":transaction3:tabeldialogTransaction"  listener="#{transactionviewBean.retDialog(transactionviewBean.dialogTransactionSelected.receiptnumber, transactionviewBean.id)}"/>

               <p:column id="Date" style="width: 200px" sortBy="#{transactionlist.date}" filterBy="#{transactionlist.date}">
                  <f:facet name="header">#{msgs.date}</f:facet>
                  #{transactionlist.date}
               </p:column>
               <p:column id="ReceiptNumber" style="width: 200px" sortBy="#{transactionlist.receiptnumber}" filterBy="#{transactionlist.receiptnumber}">
                  <f:facet name="header">#{msgs.receiptNumber}</f:facet>
                  #{transactionlist.receiptnumber}
               </p:column>
               <p:column id="Description" style="width: 300px">
                  <f:facet name="header">#{msgs.description}</f:facet>
                  #{transactionlist.description}
               </p:column>
               <p:column id="Amount" style="width: 200px">
                  <f:facet name="header">#{msgs.amount}</f:facet>
                  <h:outputText value="#{transactionlist.totalamount}">
                     <f:convertNumber currencySymbol="#{appBean.systemGlobal.currency.currencySymbol}" type="currency" maxFractionDigits="#{appBean.systemGlobal.curDigitdecimals}" />
                  </h:outputText>
               </p:column>
            </p:dataTable>
            <br/>
            <p:commandButton id="print" value="#{msgs.printButton}" update="@form" actionListener="#{occupationTabBean.addManagementType()}"/>
         </h:form>

         <h:form id="transaction3">
            <p:dialog id="dialogTransaction"
                      header="Tabel Detail Jurnal"
                      widgetVar="varDialogTransaction"
                      resizable="false"
                      showEffect="clip"
                      hideEffect="fold"
                      modal="true">
               <p:dataTable id="tabeldialogTransaction"
                            value="#{transactionviewBean.dtListTransactionDetail}"
                            var="tbldialogTransaction"

                            sortOrder="descending"
                            >
                  <p:column id="DR_Account" style="width:250px">
                     <f:facet name="header">#{msgs.DRAccount}</f:facet>
                     #{tbldialogTransaction.draccount}
                  </p:column>
                  <p:column id="CR_Account" style="width:250px">
                     <f:facet name="header">#{msgs.CRAccount}</f:facet>
                     #{tbldialogTransaction.craccount}
                  </p:column>
                  <p:column id="Amount" style="width:130px">
                     <f:facet name="header">#{msgs.amount}</f:facet>
                     <h:outputText value="#{tbldialogTransaction.amount}">
                        <f:convertNumber currencySymbol="#{appBean.systemGlobal.currency.currencySymbol}" type="currency" maxFractionDigits="#{appBean.systemGlobal.curDigitdecimals}" />
                     </h:outputText>
                  </p:column>
               </p:dataTable>
            </p:dialog>
         </h:form>
      </p:panel>

   </ui:define>
</ui:composition>